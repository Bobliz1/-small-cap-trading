# 小市值策略分享
def initialize(context):
    log.info('初始函数开始运行且全局只运行一次')
    
    大盘：沪深300
    
    run_daily
1. 盘前集合竞价：9:15-9:25
2. 开盘连续竞价：9:30-11:30
3. 午间休市：11:30-13:00
4. 下午连续竞价：13:00-14:57
5. 收盘集合竞价：14:57-15:00
6. 盘后固定价格交易：15:00-15:30（科创板、创业板）
# 小市值策略内容

每日：

开盘前：过滤停牌股票后，获得市值百分之五到百分之十的前十位股票。

开盘时：在非调仓日，根据清仓信号添加清仓股票栏，清出清仓股票栏中的股票；在调仓日：先清出清仓股票栏中的股票后，再将股票数量补充至10只。

开盘后：更新最大净值的点，便于在下一个交易日计算清仓信号。
# 251210更新

原先逻辑：根据调仓日进行调仓，但是由于清仓无法立刻清除完毕，导致调仓会收到影响，进而影响最大回撤信号，进而循环影响下一次清仓。

现有逻辑：由事件驱动，引入全局变量flag，当flag=清仓，则只进行清仓，直到仓位空了为止，并使flag=正常。当flag=正常时，若手里没有投资组合，按策略购入新的组合，并记录新的最大净值。若手里有投资组合，则先持有。当手里的投资组合达到设定的最大回撤时，则使得flag=清仓，并进入清仓模式。
# 251211更新

针对get_current_data()函数用不了的情况，经过翻阅api文档得以解决，成功过滤了停牌以及st股票。

新的问题：1.清仓机制有时候仍然失效（已解决，其实是数学直觉有问题，本身没有触发清仓） 2.当股票的短期动量已利用完，股票会进入小幅波动的状态，此时赖在手里收益几乎为0 3.添加个股的风险控制

新的研究思路：怎么在现有的策略上加花， 分为结果导向(容易过拟合）和添加新的组件，比如 1.增加风控组件  2.小市值只是针对一种类型的信号，尝试再找到其他有效的信号，并与小市值策略进行融合

结果导向：注重提升结果。    挑战：容易陷入过拟合风险，需要严格的回测机制。

添加组件：在信号观察，和风控等维度，对策略进行完善。    挑战：需要背景知识。或者是当你遇到问题后思考怎么提升。
